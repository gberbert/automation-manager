
# Implementation Plan - LinkedIn Comment Monitoring and Reply

This plan outlines the changes made to implement the LinkedIn comment monitoring and reply functionality ("Engagement Hub").

## User Request
- Monitor comments on posts generated by the application.
- Create a dashboard to view comments.
- Allow replying to comments directly via API.
- Create a configuration in "Settings" to control this activity (posts to monitor, schedule time).
- Use the existing cron process.

## Implementation Details

### Backend (`server/index.js` & `server/utils/linkedin.js`)
- **Settings**: Updated logic to read `engagement` settings (enabled, time, monitorCount).
- **LinkedIn Utils**:
    - Added `fetchComments(shareUrn, settings)`: Fetches comments from `/socialActions/{urn}/comments`.
    - Added `replyToComment(postUrn, commentUrn, text, settings)`: Posts a reply using `parentComment`.
- **Scheduler**:
    - Added a new block in `runScheduler` to handle `engagement_monitor`.
    - Logic: Fetches the last N `published` posts, checks for new comments on LinkedIn, and saves them to Firestore collection `comments` if they don't exist.
- **Routes**:
    - `POST /api/sync-comments`: Manual trigger for the sync logic.
    - `POST /api/reply-comment`: Takes `commentId` (URN), `postUrn`, and `text` to send a reply.
    - `GET /api/comments`: Lists comments from Firestore.
    - `POST /api/mark-read/:id`: Updates read status.

### Frontend (`client/`)
- **Settings Page (`Settings.jsx`)**:
    - Added "Monitor de Engajamento" UI block under Scheduler tab.
    - Configurable fields: Enable/Disable, Time, Count (default 20).
- **Engagement Page (`pages/Engagement.jsx`)**:
    - Created a new page "Engagement Hub".
    - Lists comments with tabs (Unread, All, Replied).
    - Features: Sync button, Inline Reply form, Mark as Read.
- **Routing (`App.jsx`, `Layout.jsx`)**:
    - Added `/engagement` route.
    - Added "Engagement Hub" link to the Sidebar.

### Verification
- **Build**: Ran `npm run build` successfully.
- **Logic Check**: Standard `socialActions` API usage implemented. Cron integration respects the daily lock pattern.

## Status
- **Completed**: Ready for deployment and testing.
